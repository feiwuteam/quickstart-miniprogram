{"remainingRequest":"/home/fupeng/Workspace/wechat/quickstart-miniprogram/node_modules/thread-loader/dist/cjs.js??ref--2-1!/home/fupeng/Workspace/wechat/quickstart-miniprogram/node_modules/ts-loader/index.js??ref--2-2!/home/fupeng/Workspace/wechat/quickstart-miniprogram/src/services/base.ts","dependencies":[{"path":"/home/fupeng/Workspace/wechat/quickstart-miniprogram/src/services/base.ts","mtime":1539844403312},{"path":"/home/fupeng/Workspace/wechat/quickstart-miniprogram/node_modules/cache-loader/dist/cjs.js","mtime":1537176859979},{"path":"/home/fupeng/Workspace/wechat/quickstart-miniprogram/node_modules/thread-loader/dist/cjs.js","mtime":1537176860533},{"path":"/home/fupeng/Workspace/wechat/quickstart-miniprogram/node_modules/ts-loader/index.js","mtime":1535545777399}],"contextDependencies":[],"result":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar api_1 = require(\"../config/api\");\nvar utils_1 = require(\"../utils\");\nvar http_1 = require(\"./http\");\nvar BaseService = /** @class */ (function () {\n    function BaseService(_uri) {\n        this.uri = '';\n        this.Host = http_1.HttpService.getUrl;\n        if (_uri) {\n            this.uri = _uri;\n        }\n        this.http = new http_1.HttpService();\n    }\n    BaseService.prototype.post = function (data, url, config, header) {\n        if (url === void 0) { url = ''; }\n        if (header === void 0) { header = {}; }\n        var req = {\n            url: this._getURI(url),\n            method: 'post',\n            data: data,\n            header: header\n        };\n        return this.http.jsonRequest(req, config);\n    };\n    BaseService.prototype.get = function (data, url, config, header) {\n        if (url === void 0) { url = ''; }\n        if (header === void 0) { header = {}; }\n        var req = {\n            url: this._getURI(url),\n            method: 'get',\n            data: data,\n            header: header\n        };\n        return this.http.jsonRequest(req, config);\n    };\n    BaseService.prototype.put = function (data, url, config, header) {\n        if (url === void 0) { url = ''; }\n        if (header === void 0) { header = {}; }\n        var req = {\n            url: this._getURI(url),\n            method: 'put',\n            data: data,\n            header: header\n        };\n        return this.http.jsonRequest(req, config);\n    };\n    BaseService.prototype.delete = function (data, url, config, header) {\n        if (url === void 0) { url = ''; }\n        if (header === void 0) { header = {}; }\n        var req = {\n            url: this._getURI(url),\n            method: 'delete',\n            data: data,\n            header: header\n        };\n        return this.http.jsonRequest(req, config);\n    };\n    BaseService.prototype.getUrl = function (data, url, config) {\n        if (url === void 0) { url = ''; }\n        return this._getURI(url) + '?data=' + encodeURIComponent(JSON.stringify(data));\n    };\n    BaseService.prototype._getURI = function (path) {\n        if (path && path.match(/^http/)) {\n            return path;\n        }\n        return this.uri + (path ? '/' + path : '');\n    };\n    return BaseService;\n}());\n// tslint:disable-next-line:max-classes-per-file\nvar Service = /** @class */ (function (_super) {\n    __extends(Service, _super);\n    function Service(moduleName) {\n        var _this = _super.call(this) || this;\n        var self = _this;\n        if (!api_1.default.hasOwnProperty(moduleName)) {\n            console.error('moduleName is not found please add it in file config/api', moduleName);\n            return _this;\n        }\n        var apis = api_1.default[moduleName];\n        var _loop_1 = function (k) {\n            var item = apis[k];\n            self[k] = function (data, params, header) {\n                if (data === void 0) { data = {}; }\n                if (params === void 0) { params = {}; }\n                if (header === void 0) { header = {}; }\n                return __awaiter(_this, void 0, Promise, function () {\n                    var config;\n                    return __generator(this, function (_a) {\n                        config = utils_1.deepClone(item);\n                        return [2 /*return*/, self[item.type](data, utils_1.strFormat(item.url, params), config, Object.assign({}, header, config.headers))];\n                    });\n                });\n            };\n        };\n        for (var _i = 0, _a = Object.keys(apis); _i < _a.length; _i++) {\n            var k = _a[_i];\n            _loop_1(k);\n        }\n        return _this;\n    }\n    return Service;\n}(BaseService));\nexports.default = Service;\nvar UploadFileService = /** @class */ (function () {\n    function UploadFileService(_uri) {\n        this.uri = '';\n        if (_uri) {\n            this.uri = _uri;\n        }\n        this.http = new http_1.HttpService();\n    }\n    UploadFileService.prototype.upload = function (data, url) {\n        if (url === void 0) { url = ''; }\n        return this.http.fileUpload(__assign({ url: this._getURI(url) }, data));\n    };\n    UploadFileService.prototype._getURI = function (path) {\n        return this.uri + (path ? '/' + path : '');\n    };\n    return UploadFileService;\n}());\nexports.UploadFileService = UploadFileService;\n",{"version":3,"file":"/home/fupeng/Workspace/wechat/quickstart-miniprogram/src/services/base.ts","sourceRoot":"","sources":["/home/fupeng/Workspace/wechat/quickstart-miniprogram/src/services/base.ts"],"names":[],"mappings":"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","sourcesContent":["import api from '../config/api';\nimport { deepClone, strFormat } from '../utils';\n\nimport { HttpService, IRequestExtraConfig, IRequestParams, IUploadFile } from './http';\n\nclass BaseService {\n\n    http: HttpService;\n    uri: string = '';\n\n    Host = HttpService.getUrl;\n    constructor(_uri?: string) {\n        if (_uri) {\n            this.uri = _uri;\n        }\n        this.http = new HttpService();\n    }\n\n    post(data: any, url: string = '', config: IRequestExtraConfig, header = {}): Promise<any> {\n        const req: IRequestParams = {\n            url: this._getURI(url),\n            method: 'post',\n            data,\n            header\n        };\n\n        return this.http.jsonRequest(req, config);\n    }\n\n    get(data: any, url: string = '', config: IRequestExtraConfig, header = {}): Promise<any> {\n        const req: IRequestParams = {\n            url: this._getURI(url),\n            method: 'get',\n            data,\n            header\n        };\n\n        return this.http.jsonRequest(req, config);\n    }\n\n    put(data: any, url: string = '', config: IRequestExtraConfig, header = {}): Promise<any> {\n        const req: IRequestParams = {\n            url: this._getURI(url),\n            method: 'put',\n            data,\n            header\n        };\n\n        return this.http.jsonRequest(req, config);\n    }\n\n    delete(data: any, url: string = '', config: IRequestExtraConfig, header = {}): Promise<any> {\n        const req: IRequestParams = {\n            url: this._getURI(url),\n            method: 'delete',\n            data,\n            header\n        };\n\n        return this.http.jsonRequest(req, config);\n    }\n\n    getUrl(data: any, url: string = '', config: IRequestExtraConfig) {\n        return this._getURI(url) + '?data=' + encodeURIComponent(JSON.stringify(data));\n    }\n\n    private _getURI(path?: string): string {\n        if (path && path.match(/^http/)) {\n            return path;\n        }\n        return this.uri + (path ? '/' + path : '');\n    }\n}\n\n// tslint:disable-next-line:max-classes-per-file\nexport default class Service extends BaseService {\n    constructor(moduleName: string) {\n        super();\n        const self: any = this;\n\n        if (!api.hasOwnProperty(moduleName)) {\n            console.error('moduleName is not found please add it in file config/api', moduleName);\n            return;\n        }\n\n        const apis = api[moduleName];\n        for (const k of Object.keys(apis)) {\n            const item = apis[k];\n            self[k] = async (data = {}, params = {}, header = {}): Promise<any> => {\n                const config = deepClone(item);\n                return self[item.type](data, strFormat(item.url, params), config, Object.assign({}, header, config.headers));\n            };\n        }\n    }\n}\n\nexport class UploadFileService {\n    http: HttpService;\n    uri: string = '';\n    constructor(_uri?: string) {\n        if (_uri) {\n            this.uri = _uri;\n        }\n        this.http = new HttpService();\n    }\n\n    upload(data: IUploadFile, url: string = ''): Promise<any> {\n        return this.http.fileUpload({\n            url: this._getURI(url),\n            ...data\n        } as IUploadFile);\n    }\n\n    private _getURI(path?: string): string {\n        return this.uri + (path ? '/' + path : '');\n    }\n}\n"]}]}